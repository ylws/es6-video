"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var l=t[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,i,l){return i&&e(t.prototype,i),l&&e(t,l),t}}(),CFCMVideo=function(){function e(t){_classCallCheck(this,e),this.id=document.getElementById(t),this.listening=function(e,t,i){var l=this.id;l["on"+e]=function(){i(l[t])}},this.eventsarr=["progress","loadedmetadata","timeupdate","volumechange"]}return _createClass(e,[{key:"play",value:function(){this.id.play()}},{key:"readyState",value:function(e){return{ind:e,state:this.id.readyState}}},{key:"controls",value:function(e){this.id.controls=e}},{key:"mute",value:function(e){this.id.muted=e}},{key:"progress",value:function(e){this.listening("progress","progress",e)}},{key:"pause",value:function(){this.id.pause()}},{key:"playbackRate",value:function(e){this.id.playbackRate=e}},{key:"duration",value:function(e){this.listening("loadedmetadata","duration",e)}},{key:"timeupdate",value:function(e){this.listening("timeupdate","currentTime",e)}},{key:"playtoseconds",value:function(e,t){var i=this.id;e||(e=0),2==arguments.length?i.currentTime=e+t:i.currentTime=e}},{key:"volumchange",value:function(e){this.listening("volumechange","volume",e)}},{key:"volumset",value:function(e){this.id.volume=e}},{key:"removelistening",value:function(){for(var e=this.id,t=0;t<this.eventsarr.length;t++)e["on"+this.eventsarr[t]]=null}}]),e}(),LocalVideo=function(){function e(t){_classCallCheck(this,e),this.initVal(t)}return _createClass(e,[{key:"initVal",value:function(e){this.cfg={};var t={id:"playerArea",Fullscreenid:"V_fullScreen",logo:{img:"",style:""},durationcount:0,fullscreen:!1,playnowseconds:0,font:[],fontstyle:"",channel:[],channelB:[],channelS:[],channeltitle:[],playtype:!1,model:[],knowledge:[],autoplay:!1,listtopval:20,titleshow:"block",voicenum:2,setchannel:!1,volmchannelopen:!0,slidebackfn:!1,playbackRate:[.5,1,1.25,1.5,2,2.5,3,3.5,4,4.5,5],playbackRateflag:!1,bigplay:!0,html5m3u8:!1,hlssrc:""};_extends(this.cfg,t,e),this.initcommonVal()}},{key:"initcommonVal",value:function(){var e=this.cfg;if(e.WH=this.idstyle(e.widhei?e.widhei.wid:window.innerWidth,e.widhei?e.widhei.hei:window.innerHeight),this.platformcheck().mobile||e.channelB.length<=0&&e.channel.length<=0&&e.channelS.length<=0)this.domDeal();else{1==e.channelnum&&(e.mainfile[0]=0);for(var t=0;t<e.model.length;t++)"高清"==e.model[t]?e.model[t]={type:"high",name:"高清"}:"标清"==e.model[t]?e.model[t]={type:"normal",name:"标清"}:e.model[t]={type:"surper",name:"超清"};e.setchannel&&(e.mutedid="mute_"+e.mainfile[0]),e.totaltime=e.mainfile[1],document.oncontextmenu=function(){return!1},this.domDeal(),this.keycode(),e.model.length<=1&&this.setStyle(e.V_modelcontrol,"display","none"),e.channelnum.length<=1&&this.setStyle(e.V_volumcontrol,"display","none"),this.resize()}}},{key:"setStyle",value:function(e,t,i){e.style[t]=i}},{key:"setAttr",value:function(e,t,i){e.setAttribute(t,i)}},{key:"platformcheck",value:function(){var e=!!document.createElement("video").canPlayType,t=navigator.userAgent,i=t.match(/(iPhone|Android|iPad|Mobile|uc)/i),l=null!=t.match(/.(clr)*[rv:]([11.]+)/),n=null!=t.match(/.(msie)/gi),o=null!=t.match(/.(chrome)/gi),s=null!=t.match(/.(firefox)/gi),a=void 0;return i?a="mobile":e&&!i&&(a="pch5"),{ie11:l,ie:n,checkres:a,h5video:e,mobile:i,firefox:s,chrome:o}}},{key:"keycode",value:function(){var e=this,t=this.cfg;document.onkeydown=function(i){var l=i||window.event;if("122"==l.keyCode){if(t.lock)return t.f11count||(t.f11count=setTimeout(function(){delete t.f11secondtime,delete t.f11time,delete t.lock,clearTimeout(t.f11count),delete t.f11count},1e3)),l.preventDefault?(l.preventDefault(),l.stopPropagation()):(l.cancelBubble=!0,l.returnValue=!0),!1;t.f11time?(t.f11secondtime=(new Date).getTime(),t.f11secondtime-t.f11time<=1e3&&(console.log("您的操作太频繁，请稍后再试!"),t.lock=!0)):t.f11time=(new Date).getTime(),t.fullscreen?t.fullscreen=!1:t.fullscreen=!0,e.platformcheck().ie11||e.platformcheck().ie||(l.preventDefault?l.preventDefault():l.cancelBubble=!0,t.fullscreenObj.click())}else if("32"==l.keyCode)"block"==e.getStyle(t.V_pause,"display")?t.V_pause.click():t.V_play.click();else if("38"==l.keyCode)e.opts("updownvolum","add");else if("40"==l.keyCode)e.opts("updownvolum","subtract");else if("123"==l.keyCode)return l.preventDefault?l.preventDefault():l.cancelBubble=!0,!1}}},{key:"resize",value:function(){var e=null,t=this,i=this.cfg;window.addEventListener&&(window.onresize=function(){(t.platformcheck().ie11||t.platformcheck().ie||i.fullscreen||!t.platformcheck().chrome)&&(e&&clearTimeout(e),e=setTimeout(function(){t.resizeplayer(t)},100))})}},{key:"resizeplayer",value:function(e){var t=e.cfg;t.WH.wid!=screen.width&&t.WH.hei+0!=screen.height||(t.fullscreen=!1),t.fullscreen?(t.WH=e.idstyle(screen.width,screen.height),t.fullscreen=!0):(delete t.fullscreen,t.WH=e.idstyle(t.widhei?t.widhei.wid:window.innerWidth,t.widhei?t.widhei.hei:window.innerHeight));var i="";this.platformcheck().mobile&&(i="border-bottom:1px solid #666;"),e.setAttr(t.showObj,"style","width:"+t.WH.wid+"px;height:"+(t.WH.hei-1)+"px;"+i),e.countcreatevideo(t.channelnum),e.slideRefrash(),e.addknowledge(),e.voiceRefrash(),3==t.channelnum||t.channelnum}},{key:"domDeal",value:function(){var e=this.cfg,t=this;e.showObj=this.getid(e.id);var i="";if(this.platformcheck().mobile&&(i="border-bottom:1px solid #666;"),this.setAttr(e.showObj,"style","width:"+e.WH.wid+"px;height:"+e.WH.hei+"px;"+i),e.showObj.innerHTML=this.createvideo(e.channelnum),this.platformcheck().mobile||this.slidedom(),this.countcreatevideo(e.channelnum),e.html5m3u8){var l=document.createElement("script");l.setAttribute("id","hls"),l.setAttribute("src",e.hlssrc),document.getElementById("hls")||(document.body.appendChild(l),l.onload=function(){t.opts("hlsplay")})}3==e.channelnum||e.channelnum}},{key:"slidedom",value:function(){var e=this.cfg,t=this,i=document.createElement("div");this.setAttr(i,"class","control"),this.setAttr(i,"id","V_control");var l='\n\t\t\t<div class="play iconfont icon-bofang" id="V_play" style="display: block;"></div>\n\t\t\t<div class="pause iconfont icon-zanting1"  id="V_pause" style="display: none;"></div>\n\t\t\t<div class="nowtime" id="V_nowtime">00:00:00</div>\n\t\t\t<div class="totaltime" id="V_totaltime">00:00:00</div>\n\t\t\t<div class="timeline" id="V_timeline">\n\t\t\t \t<div id="V_playin" class="playin" style="width: 0px;"></div>\n\t\t\t \t<div class="playinbg" id="V_playinbg"></div>\n\t\t\t </div>\n\t\t\t <div class="fullScreen iconfont icon-a" id="'+e.Fullscreenid+'" title="F11进入ie全屏或退出全屏"></div>\n\t\t\t <div class="scroll" id="V_scroll" volumval="50">\n\t\t\t\t <div class="scrollson" id="V_scrollson" style="left: 25px;"></div>\n\t\t\t\t <div class="scrollsonbg" id="V_scrollsonbg" style="width: 25px;"></div>\n\t\t\t </div>\n\t\t\t\n\t\t\t <div class="volum iconfont icon-yinliangkai" id="V_volum"></div>\n\t\t\t\n\t\t\t<div class="modelcontrol" id="V_modelcontrol">\n\t\t\t\t<div class="title">清晰度</div>\n\t\t\t\t<div class="modelcontrollist" id="V_modelcontrollist"></div>\n\t\t\t</div>\n\t\t\t<div class="volumcontrol" id="V_volumcontrol">\n\t\t\t\t<div class="title">声音通道</div>\n\t\t\t\t<div class="volumcontrollist" id="V_volumcontrollist"></div>\n\t\t\t</div>\n\t\t\t<div class="playcontrol" id="V_playcontrol" style="display: '+(e.playbackRateflag?"block":"none")+'">\n\t\t\t\t<div class="title">播放倍率</div>\n\t\t\t\t<div class="playcontrollist" id="V_playcontrollist"></div>\n\t\t\t</div>\n\t\t';if(i.innerHTML=l,this.getid(e.id).appendChild(i),e.bigplay){var n=document.createElement("div");this.setAttr(n,"class","bigplay iconfont icon-video"),this.setAttr(n,"id","bigplay"),this.getid(e.id).appendChild(n),e.bigplayobj=this.getid("bigplay")}if(e.logo.img){var o=document.createElement("img");o.setAttribute("class","playlogo"),o.setAttribute("src",e.logo.img),o.setAttribute("style",e.logo.style),this.getid(e.id).appendChild(o)}if(e.font.length>0){var s=document.createElement("div");s.setAttribute("id","font"),s.setAttribute("class","font"),s.setAttribute("style",e.fontstyle),this.getid(e.id).appendChild(s),e.fontobj=this.getid("font")}e.fullscreenObj=this.getid(e.Fullscreenid),e.V_control=this.getid("V_control"),e.V_modelcontrol=this.getid("V_modelcontrol"),e.V_modelcontrollist=this.getid("V_modelcontrollist"),e.playbackRateflag&&(e.V_playcontrol=this.getid("V_playcontrol"),e.V_playcontrollist=this.getid("V_playcontrollist")),e.V_volum=this.getid("V_volum"),e.V_volumcontrol=this.getid("V_volumcontrol"),e.V_play=this.getid("V_play"),e.V_pause=this.getid("V_pause"),e.V_nowtime=this.getid("V_nowtime"),e.V_totaltime=this.getid("V_totaltime"),e.V_timeline=this.getid("V_timeline"),e.V_playin=this.getid("V_playin"),e.V_playinbg=this.getid("V_playinbg"),e.V_scroll=this.getid("V_scroll"),e.V_scrollson=this.getid("V_scrollson"),e.V_scrollsonbg=this.getid("V_scrollsonbg"),e.V_volumcontrollist=this.getid("V_volumcontrollist"),this.getid(e.id).onmouseenter=function(){e.V_control.style.height="40px",e.V_control.style.overflow="visible",t.showhide("block")},this.getid(e.id).onmouseleave=function(){e.V_control.style.height="0px",e.V_control.style.overflow="hidden",t.showhide("none"),"block"==t.getStyle(e.V_volumcontrollist,"display")&&t.setStyle(e.V_volumcontrollist,"display","none"),"block"==t.getStyle(e.V_modelcontrollist,"display")&&t.setStyle(e.V_modelcontrollist,"display","none")},this.opts("init"),this.opts("duration")}},{key:"showhide",value:function(e){var t=this.cfg,i=this.getid(t.id).querySelectorAll(".outtitle");Array.prototype.slice.call(i).forEach(function(t){t.style.display=e})}},{key:"addknowledge",value:function(){for(var e=this.cfg,t=e.WH.wid/parseInt(e.mainfile[1]),i="",l=e.knowledge,n=0;n<l.length;n++)i+='<div class="knowledge"  style="left:'+t*this.timetoseconds(l[n].time)+'px;"><div class="knowledgehover"><span class="content">'+l[n].content+"</span></div></div>";e.V_playinbg.innerHTML=i;var o=e.V_playinbg.querySelectorAll(".knowledge");Array.prototype.slice.call(o).forEach(function(e){e.onmouseenter=function(e){e||window.event;this.style.overflow="visible"},e.onmouseleave=function(e){e||window.event;this.style.overflow="hidden"}})}},{key:"videoopt",value:function(){var e=this,t=this.cfg;t.V_play.onclick=function(){e.opts("play"),t.modeltypechange&&(e.opts("jump",t.playnowseconds),t.modeltypechange=!1),e.setStyle(this,"display","none"),e.setStyle(t.V_pause,"display","block")},t.V_pause.onclick=function(){e.opts("pause"),e.setStyle(this,"display","none"),e.setStyle(t.V_play,"display","block")},t.bigplay&&(t.bigplayobj.onclick=function(){t.V_play.click()}),t.model.length>1&&(t.V_modelcontrol.onclick=function(i){var l=i||window.event;l.preventDefault?(l.preventDefault(),l.stopPropagation()):(l.cancelBubble=!0,l.returnValue=!1),"none"==e.getStyle(t.V_modelcontrollist,"display")?e.setStyle(t.V_modelcontrollist,"display","block"):e.setStyle(t.V_modelcontrollist,"display","none")}),t.playbackRateflag&&(t.V_playcontrol.onclick=function(i){var l=i||window.event;l.preventDefault?(l.preventDefault(),l.stopPropagation()):(l.cancelBubble=!0,l.returnValue=!1),"none"==e.getStyle(t.V_playcontrollist,"display")?e.setStyle(t.V_playcontrollist,"display","block"):e.setStyle(t.V_playcontrollist,"display","none")}),t.V_volumcontrol.onclick=function(i){var l=i||window.event;l.preventDefault?(l.preventDefault(),l.stopPropagation()):(l.cancelBubble=!0,l.returnValue=!1),"none"==e.getStyle(t.V_volumcontrollist,"display")?e.setStyle(t.V_volumcontrollist,"display","block"):e.setStyle(t.V_volumcontrollist,"display","none")},t.V_volum.onclick=function(){var i=this.className.indexOf("icon-yinliangkai"),l=parseInt(t.V_scroll.getAttribute("volumval"));i<0?(e.setAttr(t.V_scrollsonbg,"style","width:"+l/t.voicenum+"px"),e.setAttr(t.V_scrollson,"style","left:"+l/t.voicenum+"px"),e.opts("volum",l/100,t.mutedid.split("_")[1]),e.setAttr(e.getid(t.mutedid),"class","mute selected iconon iconfont icon-yinliangkai"),this.className=this.className.replace(/(icon-yinliangguan)/gi,"icon-yinliangkai")):(t.V_volumcontrollist.querySelector(".iconon")&&(t.mutedid=t.V_volumcontrollist.querySelector(".iconon").getAttribute("id"),e.setAttr(t.V_volumcontrollist.querySelector(".iconon"),"class","mute iconoff iconfont icon-yinliangguan")),this.className=this.className.replace(/(icon-yinliangkai)/gi,"icon-yinliangguan"),e.setAttr(t.V_scrollsonbg,"style","width:0px"),e.setAttr(t.V_scrollson,"style","left:0px"),e.opts("volum",0))},t.fullscreenObj.onclick=function(){if(e.platformcheck().ie11||e.platformcheck().ie)return!1;this.className.indexOf("icon-a")>=0?(t.fullscreen=!0,e.FullScreen(t.showObj),e.setAttr(this,"class","outfullScreen iconfont icon-quanpingtuichu")):(t.fullscreen=!1,e.CancelFullScreen(),e.setAttr(this,"class","fullScreen iconfont icon-a"),e.resizeplayer(e))},this.voiceRefrash(),document.addEventListener&&(document.addEventListener("webkitfullscreenchange",function(){e.escFullScreen()},!1)||document.addEventListener("mozfullscreenchange",function(){e.escFullScreen()},!1)||document.addEventListener("fullscreenchange",function(){e.escFullScreen()},!1)||document.addEventListener("webkitfullscreenchange",function(){e.escFullScreen()},!1)),document.attachEvent&&document.attachEvent("msfullscreenchange",function(){e.escFullScreen()})}},{key:"voiceRefrash",value:function(){var e=this,t=this.cfg,i=!1;t.V_scroll.onmousedown=function(l){var n=e.getoffset(t.V_scroll).left+document.documentElement.scrollLeft,o=0,s=0;(i=!0)&&(document.onmousemove=function(i){var l=i||window.event,s=(o=(l.pageX||l.clientX)+(document.documentElement.scrollLeft||document.body.scrollLeft))-n>100/t.voicenum?100/t.voicenum:o-n;s=s<=0?0:s,e.setAttr(t.V_scrollsonbg,"style","width:"+s+"px"),e.setAttr(t.V_scrollson,"style","left:"+s+"px"),e.setAttr(t.V_scroll,"volumlen",s*t.voicenum),e.opts("volum",s/(100/t.voicenum),t.mutedid.split("_")[1]),0==s?e.setAttr(t.V_volum,"class","volum iconfont icon-yinliangguan"):e.setAttr(t.V_volum,"class","volum iconfont icon-yinliangkai")},document.onmouseup=function(l){var o=l||window.event;if(i){document.onmousemove=null;var a=(s=(o.pageX||o.clientX)+(document.documentElement.scrollLeft||document.body.scrollLeft))-n>100/t.voicenum?100/t.voicenum:s-n;a=a<=0?0:a,e.opts("volum",a/(100/t.voicenum),t.mutedid.split("_")[1]),e.setAttr(t.V_scrollsonbg,"style","width:"+a+"px"),e.setAttr(t.V_scrollson,"style","left:"+a+"px"),e.setAttr(t.V_scroll,"volumval",a*t.voicenum),0==a?e.setAttr(t.V_volum,"class","volum iconfont icon-yinliangguan"):e.setAttr(t.V_volum,"class","volum iconfont icon-yinliangkai")}i=!1})}}},{key:"slideRefrash",value:function(){var e=this,t=this.cfg,i=parseInt(t.mainfile[1]),l=i/t.WH.wid;e.setAttr(t.V_playin,"style","width:"+(t.playnowseconds/l).toFixed(2)+"px"),this["videobj_"+t.nowchannelnum].timeupdate(function(n){if(t.V_nowtime.innerHTML=e.timeformcat(parseInt(n)),t.font.length>0)for(var o=0;o<t.font.length;o++){if(parseInt(n)>=t.font[o].time&&parseInt(n)<=t.font[o].timeend){t.fontobj.innerHTML=t.font[o].content;break}t.fontobj.innerHTML=""}var s=n/l;e.setAttr(t.V_playin,"style","width:"+s.toFixed(2)+"px"),t.playnowseconds>parseInt(n)?(e.opts("jump",t.playnowseconds),t.playnowseconds=parseInt(n)):parseInt(n)==i?(t.playnowseconds=0,e.opts("jump",0),"infinite"!==t.playtype&&t.V_pause.click()):t.playnowseconds=parseInt(n)}),this.slideoptRefrash()}},{key:"slideoptRefrash",value:function(){var e=this,t=this.cfg,i=!1,l=t.WH.wid,n=1*t.mainfile[1]/l;t.V_timeline.onmousedown=function(l){var o=e.getoffset(t.showObj).left+(document.documentElement.scrollLeft||document.body.scrollLeft),s=0,a=0;(i=!0)&&(document.onmousemove=function(i){var l=i||window.event;s=(l.pageX||l.clientX)+(document.documentElement.scrollLeft||document.body.scrollLeft);var a=parseInt((s-o)*n);e.setAttr(t.V_playin,"style","width:"+(s-o)+"px"),t.playnowseconds=a,e.opts("jump",a)},document.onmouseup=function(l){var s=l||window.event;if(i){document.onmousemove=null,a=(s.pageX||s.clientX)+(document.documentElement.scrollLeft||document.body.scrollLeft);var c=parseInt((a-o)*n);e.setAttr(t.V_playin,"style","width:"+(a-o)+"px"),t.playnowseconds=c,e.opts("jump",c),"function"==typeof t.slidebackfn&&t.slidebackfn(t.playnowseconds)}i=!1})}}},{key:"timeformcat",value:function(e){var t=parseInt(e/3600),i=parseInt((e-3600*t)/60),l=parseInt(e-3600*t-60*i);return(t<10?"0"+t:t)+":"+(i<10?"0"+i:i)+":"+(l<10?"0"+l:l)}},{key:"timetoseconds",value:function(e){var t=e.split(":");return 3600*t[0]+60*t[1]+1*t[2]}},{key:"getid",value:function(e){return document.getElementById(e)}},{key:"appendvideo",value:function(e,t){for(var i=this.cfg,l=0;l<t;l++)e+='<div class="list"  id=list_'+l+"  >",e+='<div class="error"></div>',e+='<div class="loading" style="display:'+(this.platformcheck().mobile?"none":"block")+'"></div>',e+='<div class="title outtitle" style="display:'+i.titleshow+'">'+i.channeltitle[l]+"</div>","object"==_typeof(i.model[0])?"normal"===i.model[0].type?(i.defaultmodel="normal",e+='<video width="100%"  height="100%" '+(this.platformcheck().mobile?"controls=controls":"")+'  id="video_'+l+'"   type="video/mp4" src='+i.channelB[l]+">对不起，您的浏览器不支持video播放!</video>"):"high"===i.model[0].type?(i.defaultmodel="high",e+='<video width="100%"  height="100%" '+(this.platformcheck().mobile?"controls=controls":"")+'  id="video_'+l+'"   type="video/mp4" src='+i.channel[l]+">对不起，您的浏览器不支持video播放!</video>"):"super"===i.model[0].type&&(i.defaultmodel="super",e+='<video width="100%"  height="100%" '+(this.platformcheck().mobile?"controls=controls":"")+'  id="video_'+l+'"   type="video/mp4" src='+i.channelS[l]+">对不起，您的浏览器不支持video播放!</video>"):e+='<video width="100%"  height="100%" '+(this.platformcheck().mobile?"controls=controls":"")+'  id="video_'+l+'"   type="video/mp4" src='+i.channelB[l]+">对不起，您的浏览器不支持video播放!</video>",e+="</div>";return e}},{key:"createvideo",value:function(e){var t="";switch(e){case 1:case 2:case 3:case 4:t=this.appendvideo(t,e);break;case 5:case 6:var i=document.createElement("div");this.setAttr(i,"class","videopartLostDom"),t=this.appendvideo(t,e),5==e&&(t+='<div class="nosingal"  id=list_5   >NOSINGAL</div>');break;case 7:case 8:case 9:t=this.appendvideo(t,e),7==e&&(t+='<div class="nosingal" id=list_7   >NOSINGAL</div>',t+='<div class="nosingal"  id=list_8  >NOSINGAL</div>'),8==e&&(t+='<div id=list_8 class="nosingal" >NOSINGAL</div>')}return t}},{key:"countcreatevideo",value:function(e){var t=this.cfg;switch(this.platformcheck().mobile,t.WH.hei=t.WH.hei,e){case 1:this.setAttr(this.getid("list_0"),"style","width:"+(t.WH.wid-2)+"px;height:"+(t.WH.hei-2)+"px");break;case 2:for(var i,l=parseInt(t.WH.wid/2)-2,n=parseInt(t.WH.hei/2)-2,o=0;o<e;o++)0==o?(r="border-right:none;border-bottom:1px solid #666;",i=l+1):(r="border-bottom:1px solid #666;",i=l),this.setAttr(this.getid("list_"+o),"style",r+"width:"+i+"px;height:"+n+"px;top:"+parseInt((t.WH.hei-n)/2-t.listtopval)+"px");break;case 3:for(var l=parseInt(t.WH.wid/3),n=parseInt(t.WH.hei/2),s=parseInt((t.WH.hei-2*n)/2),o=0;o<e;o++)0==o?this.setAttr(this.getid("list_"+o),"style","border-right:none;width:"+(2*l-1)+"px;height:"+2*n+"px;top:"+s+"px"):1==o?this.setAttr(this.getid("list_"+o),"style","border-bottom:none;width:"+(l-2)+"px;height:"+n+"px;top:"+s+"px"):this.setAttr(this.getid("list_"+o),"style","width:"+(l-2)+"px;height:"+(n-1)+"px;top:"+s+"px");break;case 4:for(var l=parseInt(t.WH.wid/2)-2,n=parseInt(t.WH.hei/2)-2,a=l+1,o=0;o<e;o++){r="";0==o?(r="border-right:none;border-bottom:none;",this.setAttr(this.getid("list_"+o),"style",r+"width:"+a+"px;height:"+n+"px;")):1==o?(r="border-bottom:none;",this.setAttr(this.getid("list_"+o),"style",r+"width:"+l+"px;height:"+n+"px;")):2==o?(r="border-right:none;",this.setAttr(this.getid("list_"+o),"style",r+"width:"+a+"px;height:"+n+"px;")):this.setAttr(this.getid("list_"+o),"style",r+"width:"+l+"px;height:"+n+"px;")}break;case 5:case 6:var l=parseInt(t.WH.wid/3),n=parseInt(t.WH.hei/3),c=document.createElement("div");this.setAttr(c,"class","videopartLostDom");for(o=0;o<e;o++)0==o?this.setAttr(this.getid("list_"+o),"style","width:"+(2*l-1)+"px;height:"+(2*n-1)+"px;border-right:none;border-bottom:none;"):1==o?this.setAttr(this.getid("list_"+o),"style","width:"+(l-2)+"px;height:"+(n-1)+"px;border-bottom:none;"):2==o?this.setAttr(this.getid("list_"+o),"style","width:"+(l-2)+"px;height:"+(n-1)+"px;border-bottom:none;"):3==o?this.setAttr(this.getid("list_"+o),"style","width:"+(l-2)+"px;margin-right:"+(t.WH.wid-3*l)+"px;height:"+(n-1)+"px;float:right;border-left:none;"):4==o?this.setAttr(this.getid("list_"+o),"style","width:"+(l-2)+"px;height:"+(n-1)+"px;float:right;"):5==o&&this.setAttr(this.getid("list_"+o),"style","width:"+(l-1)+"px;height:"+(n-1)+"px;border-right:none;");5==e&&this.setAttr(this.getid("list_5"),"style","border-right:none;width:"+(l-1)+"px;height:"+(n-1)+"px;line-height:"+n+"px;text-align:center;color:#fff");break;case 7:case 8:case 9:for(var l=parseInt(t.WH.wid/3)-2,n=parseInt(t.WH.hei/3)-1,a=l+1,o=0;o<e;o++){var r;0==o||1==o||3==o||4==o||6==o||7==o?(r="border-right:none;",this.setAttr(this.getid("list_"+o),"style",r+"width:"+a+"px;height:"+n+"px;")):(r="",this.setAttr(this.getid("list_"+o),"style",r+"width:"+l+"px;height:"+n+"px;"))}7==e&&(this.setAttr(this.getid("list_7"),"style","border-right:none;width:"+a+"px;float:left;height:"+n+"px;line-height:"+n+"px;text-align:center;color:#fff"),this.setAttr(this.getid("list_8"),"style","width:"+l+"px;float:left;height:"+n+"px;line-height:"+n+"px;text-align:center;color:#fff")),8==e&&this.setAttr(this.getid("list_8"),"style","width:"+l+"px;float:left;height:"+n+"px;line-height:"+n+"px;text-align:center;color:#fff")}}},{key:"getStyle",value:function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle[t]}},{key:"getoffset",value:function(e,t){if(null==e)return t;t||((t={}).top=0,t.left=0);var i=this.getStyle(e,"position");if("absolute"==i||"relative"==i){if(e.getBoundingClientRect&&null!=navigator.userAgent.toLowerCase().match(/.(msie)/))return t.top+=e.getBoundingClientRect.top,t.left+=e.getBoundingClientRect.left,t;t.top+=e.offsetTop,t.left+=e.offsetLeft}else t.top+=0,t.left+=0;return this.getoffset(e.parentElement,t)}},{key:"idstyle",value:function(e,t){var i={},l=t;return.5625*e>t?t/.5625<=e?(i.hei=t,i.wid=parseInt(t/.5625)):(l-=10,this.idstyle(e,l)):(i.hei=parseInt(.5625*e),i.wid=e),i}},{key:"channelplayEvent",value:function(e){var t=this,i=(this.cfg,e.querySelectorAll(".modelspan"));Array.prototype.slice.call(i).forEach(function(i,l){i.addEventListener("click",function(i){var l=i||window.event;l.preventDefault?(l.preventDefault(),l.stopPropagation()):(l.cancelBubble=!0,l.returnValue=!1),e.querySelector(".selected").setAttribute("class","modelspan");var n=1*this.textContent;this.setAttribute("class","modelspan selected"),t.opts("playbackRate",n)},!1)})}},{key:"channelmodelEvent",value:function(e){var t=this,i=this.cfg,l=e.querySelectorAll(".modelspan");Array.prototype.slice.call(l).forEach(function(l,n){l.addEventListener("click",function(l){var n=l||window.event;n.preventDefault?(n.preventDefault(),n.stopPropagation()):(n.cancelBubble=!0,n.returnValue=!1),t.opts("removelistening"),e.querySelector(".selected").setAttribute("class","modelspan"),i.V_pause.click(),t.opts("loading","block"),t.opts("error","none");var o=this.getAttribute("type");i.html5m3u8?t.opts("hlsplay"):"normal"==o?(i.defaultmodel="normal",t.opts("urlreplace",i.channelB)):"super"==o?(i.defaultmodel="super",t.opts("urlreplace",i.channelS)):(i.defaultmodel="high",t.opts("urlreplace",i.channel)),i.durationcount=0,t.opts("init"),t.opts("duration","jump")},!1)})}},{key:"channelmuteEvent",value:function(e){var t=this,i=this.cfg,l=e.querySelectorAll(".mute"),n=i.V_scroll.getAttribute("volumval");Array.prototype.slice.call(l).forEach(function(l,o){l.addEventListener("click",function(l){var s=l||window.event;s.preventDefault?(s.preventDefault(),s.stopPropagation()):(s.cancelBubble=!0,s.returnValue=!1);var a=this.getAttribute("class");i.mutedid=this.getAttribute("id"),i.volmchannelopen?(t.setAttr(this,"class","mute selected iconon iconfont icon-yinliangkai"),t.opts("volum",n/100,o)):null!=a.match(/(iconon)/gi)?(t.setAttr(this,"class","mute iconoff iconfont icon-yinliangguan"),i.V_volum.click()):(e.querySelector(".iconon")&&t.setAttr(e.querySelector(".iconon"),"class","mute iconoff iconfont icon-yinliangguan"),t.setAttr(this,"class","mute selected iconon iconfont icon-yinliangkai"),null!=i.V_volum.className.indexOf("icon-yinliangguan")?i.V_volum.click():t.opts("volum",n/100,o))},!1)})}},{key:"FullScreen",value:function(e){if(e.requestFullScreen)e.requestFullScreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullScreen)e.webkitRequestFullScreen();else if(e.msRequestFullScreen)e.msRequestFullScreen();else{if(!e.msRequestFullscreen)return!0;e.msRequestFullscreen()}}},{key:"CancelFullScreen",value:function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else{if(!document.msExitFullScreen)return!0;document.msExitFullScreen()}}},{key:"escFullScreen",value:function(){var e=this.cfg;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||(this.CancelFullScreen(),e.fullscreenObj.setAttribute("class","fullScreen iconfont icon-a"))}},{key:"opts",value:function(e,t,i){var l=this,n=this.cfg,o=this.getid(n.id).querySelectorAll(".list"),s=this,a="",c=void 0;if("updownvolum"==e){var r=parseInt(n.V_scroll.getAttribute("volumval"));"add"==t?(r+=2)>100&&(r=100):(r-=2)<=0&&(r=0);var d=n.mutedid.split("_")[1];return this["videobj_"+d].volumset(r/100),this.setAttr(n.V_scroll,"volumval",r),r<=0?(this.setAttr(n.V_volum,"class","volum iconfont icon-yinliangguan"),this["videobj_"+d].mute(!0)):(this.setAttr(n.V_volum,"class","volum iconfont icon-yinliangkai"),this["videobj_"+d].mute(!1)),this.setAttr(n.V_scrollsonbg,"style","width:"+r/2+"px"),void this.setAttr(n.V_scrollson,"style","left:"+r/2+"px")}for(var u=0;u<o.length;u++)switch(this["videobj_"+u]&&(c=this["videobj_"+u].readyState(u)),e){case"removelistening":this["videobj_"+u]&&this["videobj_"+u].removelistening();break;case"init":this["videobj_"+u]=new CFCMVideo("video_"+u),document.onselectstart=function(){return!1},"none"==this.getStyle(this.getid("video_"+u),"display")&&this.setStyle(this.getid("video_"+u),"display","block"),this["videobj_"+u].id.ondblclick=function(e){s.platformcheck().ie?alert("对不起,您的浏览器不支持双击全屏!"):(n.fullscreen=!0,s.FullScreen(this),this.setAttr(n.fullscreenObj,"class","outfullScreen iconfont icon-quanpingtuichu"))},n.setchannel?u!=n.mainfile[0]?(this["videobj_"+u].mute("false"),a+='<div id="mute_'+u+'" class="mute iconoff iconfont icon-yinliangguan" title="'+n.channeltitle[u]+'">'+n.channeltitle[u]+"</div>"):(a+='<div id="mute_'+u+'" class="mute selected iconon iconfont icon-yinliangkai" title="'+n.channeltitle[u]+'">'+n.channeltitle[u]+"</div>",n.mutedid="mute_"+u):n.mutedid&&n.mutedid.split("_")[1]==u?a+='<div id="mute_'+u+'" class="mute selected iconon iconfont icon-yinliangkai" title="'+n.channeltitle[u]+'">'+n.channeltitle[u]+"</div>":(this["videobj_"+u].mute("false"),a+='<div id="mute_'+u+'" class="mute iconoff iconfont icon-yinliangguan" title="'+n.channeltitle[u]+'">'+n.channeltitle[u]+"</div>");break;case"duration":this.durationcallback(u,t);break;case"play":0!=c.state?("block"==this.getStyle(n.bigplayobj,"display")&&(n.bigplayobj.style.display="none"),this["videobj_"+u].play()):this.errordeal(u);break;case"hlsplay":this["m3u8_"+u]=document.getElementById("video_"+u),this.setStyle(this.getid("list_"+u).querySelector(".loading"),"display","none"),Hls.isSupported()?function(){var e=l["m3u8_"+u];l["hls_"+u]=new Hls,"high"==n.defaultmodel?l["hls_"+u].loadSource(n.channel[u]):"normal"==n.defaultmodel?l["hls_"+u].loadSource(n.channelB[u]):l["hls_"+u].loadSource(n.channelS[u]),l["hls_"+u].attachMedia(s["m3u8_"+u]),l["hls_"+u].on(Hls.Events.MANIFEST_PARSED,function(){e.play(),n.bigplayobj.style.display="none",s.setStyle(n.V_play,"display","none"),s.setStyle(n.V_pause,"display","block")})}():function(){var e=l["m3u8_"+u];l["m3u8_"+u].canPlayType("application/vnd.apple.mpegurl")&&("high"==n.defaultmodel?l["m3u8_"+u].src=n.channel[u]:"normal"==n.defaultmodel?l["m3u8_"+u].src=n.channelB[u]:l["m3u8_"+u].src=n.channelS[u],l["m3u8_"+u].addEventListener("canplay",function(){e.play(),n.bigplayobj.style.display="none",s.setStyle(n.V_play,"display","none"),s.setStyle(n.V_pause,"display","block")}))}();break;case"pause":0!=c.state?("none"==this.getStyle(n.bigplayobj,"display")&&(n.bigplayobj.style.display="block"),this["videobj_"+u].pause()):this.errordeal(u);break;case"playbackRate":0!=c.state?this["videobj_"+u].playbackRate(t):this.errordeal(u);break;case"jump":0!=c.state?(i?"add"==i?t+5>=n.totaltime?this["videobj_"+u].playtoseconds(0):this["videobj_"+u].playtoseconds(t+5):t-5<=0?this["videobj_"+u].playtoseconds(0):this["videobj_"+u].playtoseconds(t-5):this["videobj_"+u].playtoseconds(t),n.playnowseconds=t):this.errordeal(u);break;case"volum":0!=c.state?void 0!=i?i==u?(this["videobj_"+u].volumset(t),0==t?(this.setAttr(n.V_volumcontrollist.children[u],"class","mute iconoff iconfont icon-yinliangguan"),this["videobj_"+u].mute(!0)):(this.setAttr(n.V_volumcontrollist.children[u],"class","mute selected iconon iconfont icon-yinliangkai"),this["videobj_"+u].mute(!1))):(this["videobj_"+u].volumset(0),this["videobj_"+u].mute(!0),this.setAttr(n.V_volumcontrollist.children[u],"class","mute iconoff iconfont icon-yinliangguan")):(this["videobj_"+u].volumset(t),0==t?(this.setAttr(n.V_volumcontrollist.children[u],"class","mute iconoff iconfont icon-yinliangguan"),this["videobj_"+u].mute(!0)):(this.setAttr(n.V_volumcontrollist.children[u],"class","mute selected iconon iconfont icon-yinliangkai"),this["videobj_"+u].mute(!1))):this.errordeal(u);break;case"urlreplace":this.setAttr(this["videobj_"+u].id,"src",t[u]);break;case"loading":this.setStyle(this.getid("list_"+u).querySelector(".loading"),"display",t);break;case"error":this.setStyle(this.getid("list_"+u).querySelector(".error"),"display",t)}if("init"==e){var h="";if(n.model.length>0)for(var p=0;p<n.model.length;p++)n.defaultmodel==n.model[p].type?h+='<span class="modelspan selected" type='+n.model[p].type+">"+n.model[p].name+"</span>":h+='<span class="modelspan" type='+n.model[p].type+">"+n.model[p].name+"</span>";if(n.playbackRateflag){var m="";if(n.playbackRate.length>0)for(var v=n.playbackRate.length-1;v>=0;v--)1==n.playbackRate[v]?m+='<span class="modelspan selected" >'+n.playbackRate[v]+"</span>":m+='<span class="modelspan" >'+n.playbackRate[v]+"</span>";""==n.V_playcontrollist.innerHTML&&(n.V_playcontrollist.innerHTML=m),this.setAttr(n.V_playcontrollist,"style","top:-"+(20*(n.playbackRate.length+1)+11)+"px;"),this.channelplayEvent(n.V_playcontrollist)}n.V_modelcontrollist.innerHTML=h,n.V_volumcontrollist.innerHTML=a,this.setAttr(n.V_modelcontrollist,"style","top:-"+(20*(n.model.length+1)+11)+"px;"),this.setAttr(n.V_volumcontrollist,"style","top:-"+(20*(o.length+1)+11)+"px;"),this.channelmuteEvent(n.V_volumcontrollist),this.channelmodelEvent(n.V_modelcontrollist)}}},{key:"errordeal",value:function(e){var t=this.cfg;if("block"==this.getStyle(this.getid("video_"+e),"display")){this.setStyle(this.getid("video_"+e),"display","none"),this.setStyle(this.getid("mute_"+e),"display","none");var i=parseInt(this.getStyle(t.V_volumcontrollist,"top"))+20;t.V_volumcontrollist.style.top=i+"px"}this["videobj_"+e]&&(this.setStyle(this.getid("list_"+e).querySelector(".loading"),"display","none"),this.setStyle(this.getid("list_"+e).querySelector(".error"),"display","block"))}},{key:"durationcallback",value:function(e,t){var i=this,l=this.cfg;this["videobj_"+e].duration(function(n){if(l.setchannel&&e==l.mainfile[0]&&(l.totaltime=parseInt(n),l.nowchannelnum=e,l.V_totaltime.innerHTML=i.timeformcat(parseInt(n)),l.mainfile[1]=parseInt(n),i.videoopt(),i.addknowledge()),!l.setchannel&&!l.mainfile[1]){l.mutedid="mute_"+e,l.nowchannelnum=e;var o=i.getid(l.mutedid);o.className=o.className.replace(/(icon-yinliangguan)/gi,"selected icon-yinliangkai"),l.V_totaltime.innerHTML=i.timeformcat(parseInt(n)),l.mainfile[1]=parseInt(n),l.totaltime=parseInt(n),i.videoopt(),i.addknowledge(),i["videobj_"+e].mute(!1),i["videobj_"+e].volumset(.5)}if(i.slideRefrash(),i.setStyle(i.getid("list_"+e).getElementsByClassName("loading")[0],"display","none"),l.durationcount++,l.durationcount==l.channelnum){if("jump"==t&&(i.opts("jump",l.playnowseconds),i.opts("loading","none")),l.autojump)if(l.totaltime<l.autojump){var s=parseInt(l.autojump/l.totaltime);i.opts("jump",l.autojump-s*l.totaltime)}else i.opts("jump",l.autojump);l.autoplay&&l.V_play.click()}else console.log("未加载完全，播放等待中"+e)})}},{key:"remove",value:function(e){var t=e.parentNode;t&&t.removeChild(e)}}]),e}();
export function LocalVideo(param) {
	return new LocalVideo(param)
}